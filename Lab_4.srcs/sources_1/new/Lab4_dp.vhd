--------------------------------------------------------------------
-- Name:	Maxwell J. Pembo
-- Date:	1-29-2025
-- File:	Lab4_datapath.vhdl
-- HW:		Lab 4
-- Crs:		CSCE 436
--
-- datapath for project
--
-- Academic Integrity Statement: I certify that, while others may have 
-- assisted me in brain storming, debugging and validating this program, 
-- the program itself is my own work. I understand that submitting code 
-- which is the work of other individuals is a violation of the honor   
-- code.  I also understand that if I knowingly give my original work to 
-- another individual is also a violation of the honor code. 
------------------------------------------------------------------------- 


library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
use IEEE.NUMERIC_STD.ALL;
library UNIMACRO;							-- This contains links to the Xilinx block RAM
use UNIMACRO.vcomponents.all;

library UNISIM;
use UNISIM.VComponents.all;


entity Lab4_dp is
    PORT(
         clk : IN  std_logic;
         reset_n : IN  std_logic;
         ac_mclk : out STD_LOGIC;
         ac_adc_sdata : in STD_LOGIC;
         ac_dac_sdata : out STD_LOGIC;
         ac_bclk : out STD_LOGIC;
         ac_lrclk : out STD_LOGIC;
         scl : inout STD_LOGIC;
         sda : inout STD_LOGIC;
         --tmds : OUT  std_logic_vector(3 downto 0);
         --tmdsb : OUT  std_logic_vector(3 downto 0);
         sw : OUT  std_logic_vector(2 downto 0);
         cw : IN  std_logic_vector(2 downto 0);
         btn : IN  std_logic_vector(4 downto 0);
         slide: in	std_logic_vector(7 downto 0));
end Lab4_dp;




architecture Behavioral of Lab4_dp is

-- Instantiate components
component Audio_Codec_Wrapper 
    Port ( clk : in STD_LOGIC;
        reset_n : in STD_LOGIC;
        ac_mclk : out STD_LOGIC;
        ac_adc_sdata : in STD_LOGIC;
        ac_dac_sdata : out STD_LOGIC;
        ac_bclk : out STD_LOGIC;
        ac_lrclk : out STD_LOGIC;
        ready : out STD_LOGIC;
        L_bus_in : in std_logic_vector(17 downto 0); -- left channel input to DAC
        R_bus_in : in std_logic_vector(17 downto 0); -- right channel input to DAC
        L_bus_out : out  std_logic_vector(17 downto 0); -- left channel output from ADC
        R_bus_out : out  std_logic_vector(17 downto 0); -- right channel output from ADC
        scl : inout STD_LOGIC;
        sda : inout STD_LOGIC);
end component;

component addressCntr 
        port(	clk, reset_n: in std_logic; 
                crtl: in std_logic_vector (1 downto 0);
                Phase_inc : in unsigned(15 downto 0);
    	        address : out unsigned(15 downto 0));
end component;



-- Signals
    signal ready :  STD_LOGIC;
    signal L_bus_in : std_logic_vector(17 downto 0); -- left channel input to DAC
    signal R_bus_in :  std_logic_vector(17 downto 0); -- right channel input to DAC
    signal L_bus_out  : std_logic_vector(17 downto 0); -- left channel output from ADC
    signal R_bus_out : std_logic_vector(17 downto 0); -- right channel output from ADC
    signal chan :  STD_LOGIC := '0';

    signal old_button, button_activity: std_logic_vector(4 downto 0);
    
    signal phase_inc : unsigned(15 downto 0) := x"0000";
    signal amplitude  : unsigned(15 downto 0):= x"0AA0";
    
    signal RamReset: std_logic;
    signal DI, DO1, DI2 ,DO2, DO: std_logic_vector(15 downto 0);
    signal vecAddrRead : unsigned(9 downto 0);
    signal addressOut : unsigned(15 downto 0);
    
    
    signal Signal1: unsigned(31 downto 0);
    signal Signal1_signed: signed(15 downto 0);
    signal Signal1_extend: std_logic_vector(17 downto 0);
    

begin

    addressCntr_inst : addressCntr Port Map(   
        clk => clk,
        reset_n => reset_n, 
		crtl => cw(1 downto 0), 
		Phase_inc => phase_inc,
		address => addressOut
	); 

sw(0) <= ready;
vecAddrRead <= addressOut(15 downto 6);


    Audio_Codec_Wrapper_inst : Audio_Codec_Wrapper Port Map(
        clk => clk,
        reset_n => reset_n,
        ac_mclk => ac_mclk,
        ac_adc_sdata => ac_adc_sdata,
        ac_dac_sdata  => ac_dac_sdata,
        ac_bclk => ac_bclk,
        ac_lrclk => ac_lrclk,
        ready => ready,
        L_bus_in => L_bus_in,
        R_bus_in => (others => '0'),
        L_bus_out => OPEN,
        R_bus_out => OPEN,
        scl => scl,
        sda => sda
    );
    
        RamReset <= not reset_n;
	sampleMemory: BRAM_SDP_MACRO
		generic map (
			BRAM_SIZE => "18Kb", 					-- Target BRAM, "18Kb" or "36Kb"
			DEVICE => "7SERIES", 					-- Target device: "VIRTEX5", "VIRTEX6", "SPARTAN6, 7SERIES"
			DO_REG => 0, 							-- Optional output register disabled
			INIT => X"000000000000000000",			-- Initial values on output port
			INIT_FILE => "NONE",					-- Not sure how to initialize the RAM from a file
			WRITE_WIDTH => 16, 						-- Valid values are 1-72 (37-72 only valid when BRAM_SIZE="36Kb")
			READ_WIDTH => 16, 						-- Valid values are 1-72 (37-72 only valid when BRAM_SIZE="36Kb")
			SIM_COLLISION_CHECK => "NONE", 			-- Collision check enable "ALL", "WARNING_ONLY", "GENERATE_X_ONLY" or "NONE"
			SRVAL => X"000000000000000000",			-- Set/Reset value for port output
		    INIT_00  => X"8BC28AF98A31896988A087D8870F8646857E84B583EC8323825A819180C88000",
            INIT_01  => X"9830976A96A495DF95189452938C92C591FE913790708FA98EE18E198D528C8A",
		    INIT_02  => X"A462A3A1A2E0A21FA15DA09B9FD89F159E529D8F9CCB9C079B439A7F99BA98F5",
		    INIT_03  => X"B03BAF81AEC6AE0AAD4FAC93ABD6AB19AA5CA99EA8E0A821A762A6A2A5E3A523",
		    INIT_04  => X"BB9DBAEBBA38B985B8D1B81DB768B6B3B5FDB546B48FB3D8B320B267B1AEB0F5",
		    INIT_05  => X"C66CC5C4C51BC472C3C8C31DC271C1C5C119C06BBFBDBF0FBE60BDB0BD00BC4F",
		    INIT_06  => X"D08ECFF2CF54CEB6CE17CD78CCD7CC36CB94CAF2CA4FC9ABC906C861C7BBC714",
		    INIT_07  => X"D9E9D95AD8CAD839D7A7D714D680D5EBD556D4C0D429D391D2F8D25FD1C5D12A",
		    INIT_08  => X"E267E1E6E164E0E2E05EDFD9DF53DECDDE45DDBDDD34DCAADC1FDB93DB06DA78",
		    INIT_09  => X"E9F3E982E90FE89CE828E7B3E73CE6C5E64DE5D3E559E4DEE462E3E5E366E2E7",
		    INIT_0A  => X"F07AF019EFB8EF55EEF1EE8DEE27EDC0ED58ECEFEC85EC1AEBAEEB41EAD2EA63",
		    INIT_0B  => X"F5EBF59CF54DF4FCF4AAF456F402F3ACF356F2FEF2A5F24CF1F1F194F137F0D9",
		    INIT_0C  => X"FA3AF9FEF9C1F982F942F902F8BFF87CF838F7F2F7ACF764F71BF6D1F685F639",
		    INIT_0D  => X"FD5CFD33FD09FCDDFCB1FC83FC54FC23FBF2FBBFFB8BFB56FB1FFAE8FAAFFA75",
		    INIT_0E  => X"FF4AFF34FF1DFF05FEECFED1FEB5FE98FE7AFE5BFE3AFE18FDF5FDD1FDABFD84",
		    INIT_0F  => X"FFFEFFFCFFF8FFF4FFEEFFE7FFDFFFD6FFCBFFBFFFB2FFA4FF94FF84FF72FF5E",
		    INIT_10  => X"FF76FF88FF98FFA8FFB6FFC2FFCEFFD8FFE1FFE9FFF0FFF5FFF9FFFCFFFEFFFE",
		    INIT_11  => X"FDB5FDDAFDFEFE21FE43FE63FE82FEA0FEBDFED8FEF2FF0CFF23FF3AFF4FFF63",
		    INIT_12  => X"FABEFAF6FB2EFB64FB99FBCCFBFFFC30FC60FC8FFCBCFCE9FD14FD3EFD67FD8F",
		    INIT_13  => X"F699F6E4F72EF776F7BEF804F84AF88EF8D1F912F953F993F9D1FA0EFA4AFA85",
		    INIT_14  => X"F150F1ACF208F263F2BDF315F36DF3C3F418F46CF4BFF511F561F5B1F5FFF64D",
		    INIT_15  => X"EAEFEB5DEBCAEC36ECA1ED0AED73EDDBEE41EEA7EF0BEF6FEFD1F032F092F0F2",
		    INIT_16  => X"E387E405E482E4FEE579E5F3E66CE6E4E75BE7D1E846E8BAE92DE99FEA10EA80",
		    INIT_17  => X"DB2ADBB7DC43DCCEDD58DDE1DE69DEF0DF76DFFCE080E104E186E208E289E309",
		    INIT_18  => X"D1EDD287D320D3B9D450D4E7D57DD612D6A6D73AD7CDD85ED8EFD97FDA0FDA9D",
		    INIT_19  => X"C7E6C88CC931C9D5CA79CB1CCBBFCC60CD01CDA1CE41CEDFCF7DD01AD0B7D152",
		    INIT_1A  => X"BD2DBDDEBE8DBF3CBFEBC098C146C1F2C29EC349C3F4C49EC547C5F0C698C73F",
		    INIT_1B  => X"B1DEB297B350B407B4BFB576B62CB6E2B797B84CB900B9B4BA67BB19BBCBBC7D",
		    INIT_1C  => X"A615A6D4A794A852A911A9CFAA8DAB4AAC07ACC3AD80AE3BAEF6AFB1B06BB125",
		    INIT_1D  => X"99ED9AB29B769C3A9CFE9DC29E859F48A00BA0CDA18FA251A312A3D3A494A555",
		    INIT_1E  => X"8D858E4D8F158FDC90A4916B923292F993BF9486954C961296D8979D98639928",
		    INIT_1F  => X"80FD81C6828F8357842084E985B2867B8743880C88D4899D8A658B2D8BF68CBE",
		    INIT_20  => X"7471753A760276CA7793785B792479ED7AB57B7E7C477D107DD97EA27F6B8034",
		    INIT_21  => X"680368C8698E6A546B1A6BE06CA76D6E6E356EFC6FC3708A7152721A72E173A9",
		    INIT_22  => X"5BCF5C905D515E135ED55F976059611C61E062A36367642B64EF65B46678673D",
		    INIT_23  => X"4FF450AF516A522552E1539D545A551755D556935751581058CF598E5A4E5B0E",
		    INIT_24  => X"4490454245F546A9475D481148C6497C4A324AE84B9F4C574D0F4DC84E814F3A",
		    INIT_25  => X"39BE3A673B103BB93C643D0F3DBA3E663F133FC1406F411E41CD427D432D43DE",
		    INIT_26  => X"2F9A303630D43172321132B1335133F33495353735DB367F372437C938703917",
		    INIT_27  => X"263B26CA275B27EC287F291229A62A3A2AD02B662BFD2C952D2E2DC82E622EFE",
		    INIT_28  => X"1DB91E3A1EBC1F3F1FC4204820CE215521DD226522EF237924052491251E25AC",
		    INIT_29  => X"1629169B170D178117F6186B18E2195919D21A4B1AC61B411BBE1C3B1CB91D39",
		    INIT_2A  => X"0F9E0FFF106110C41128118D11F3125A12C2132B13961401146D14DB154915B9",
		    INIT_2B  => X"0A280A770AC70B190B6B0BBE0C130C690CC00D180D710DCB0E260E830EE00F3F",
		    INIT_2C  => X"05D40611064E068D06CD070F0751079407D9081F086608AE08F70942098E09DA",
		    INIT_2D  => X"02AD02D70301032D035A038803B803E9041A044E048204B704EE0526055F0599",
		    INIT_2E  => X"00BB00D100E80100011A01350151016E018D01AD01CE01F002130238025E0285",
		    INIT_2F  => X"000200040008000C0012001A0022002C003700430050005F006F0080009200A6",
		    INIT_30  => X"008400730062005400460039002E0024001B0014000E00090005000200010001",
		    INIT_31  => X"0240021B01F801D501B4019401750157013B0120010600ED00D600BF00AA0097",
		    INIT_32  => X"053204FA04C3048D0459042603F403C3039303640337030B02E002B6028E0266",
		    INIT_33  => X"0953090808BE0876082F07E807A40760071D06DC069B065C061E05E105A6056B",
		    INIT_34  => X"0E970E3B0DDF0D850D2B0CD30C7C0C260BD10B7D0B2B0AD90A890A3A09EB099E",
		    INIT_35  => X"14F31486141913AD134312D91271120A11A3113E10DA107710150FB40F540EF5",
		    INIT_36  => X"1C571BD91B5D1AE11A6619EC197418FC1885180F179B172716B4164215D21562",
		    INIT_37  => X"24B024242398230D228421FB217320EC20661FE11F5D1ED91E571DD51D551CD5",
		    INIT_38  => X"2DEA2D502CB72C1F2B882AF12A5B29C62932289F280D277B26EA265A25CB253D",
		    INIT_39  => X"37EE374836A335FF355B34B93416337532D43234319530F730592FBC2F202E85",
		    INIT_3A  => X"42A441F4414440953FE73F3A3E8D3DE03D343C893BDF3B353A8C39E3393C3895",
		    INIT_3B  => X"4DF14D384C804BC84B114A5A49A448EE4839478446D0461D456A44B844064354",
		    INIT_3C  => X"59B958F9583A577B56BD55FF5541548453C7530B524F519350D8501E4F634EAA",
		    INIT_3D  => X"65DF651A6456639262CE620B614760855FC25F005E3E5D7C5CBB5BFA5B395A79",
		    INIT_3E  => X"7246717E70B66FEF6F286E616D9A6CD36C0C6B466A8069BA68F4682E676966A4",
		    INIT_3F  => X"7ECE7E057D3C7C737BAB7AE27A197950788877BF76F7762E7566749E73D6730E")
		port map (
			DO => DO1,						-- Output read data port, width defined by READ_WIDTH parameter
			RDADDR => std_logic_vector(vecAddrRead),					-- Input address, width defined by port depth
			RDCLK => clk,	 						-- 1-bit input clock
			RST => RamReset,							-- active high reset
			RDEN => '1',							-- read enable 
			REGCE => '1',							-- 1-bit input read output register enable - ignored
			DI => DI,						-- Input data port, width defined by WRITE_WIDTH parameter
			WE => "00" ,					-- since RAM is byte read, this determines high or low byte
			WRADDR => "0000000000",					-- Input write address, width defined by write port depth
			WRCLK => clk,							-- 1-bit input write clock
			WREN => '0' -- CHANGE TO MUX
			);	
			
			
	chan2Memory: BRAM_SDP_MACRO
		generic map (
			BRAM_SIZE => "18Kb", 					-- Target BRAM, "18Kb" or "36Kb"
			DEVICE => "7SERIES", 					-- Target device: "VIRTEX5", "VIRTEX6", "SPARTAN6, 7SERIES"
			DO_REG => 0, 							-- Optional output register disabled
			INIT => X"000000000000000000",			-- Initial values on output port
			INIT_FILE => "NONE",					-- Not sure how to initialize the RAM from a file
			WRITE_WIDTH => 16, 						-- Valid values are 1-72 (37-72 only valid when BRAM_SIZE="36Kb")
			READ_WIDTH => 16, 						-- Valid values are 1-72 (37-72 only valid when BRAM_SIZE="36Kb")
			SIM_COLLISION_CHECK => "NONE", 			-- Collision check enable "ALL", "WARNING_ONLY", "GENERATE_X_ONLY" or "NONE"
			SRVAL => X"000000000000000000",			-- Set/Reset value for port output
		    
		    INIT_00 => X"0BE50B190A4C098008B407E8071D0651058604BB03F10327025D019300CA0001",
INIT_01 => X"18C517F617271658158A14BB13ED131F1251118310B50FE70F1A0E4C0D7F0CB2",
INIT_02 => X"25B724E824192349227A21AB20DC200C1F3D1E6E1D9F1CD01C011B311A621993",
INIT_03 => X"329D31D0310230342F672E982DCA2CFC2C2D2B5F2A9029C228F3282427552686",
INIT_04 => X"3F5B3E913DC63CFC3C313B663A9A39CF39033837376B369E35D235053438336B",
INIT_05 => X"4BD24B0D4A48498248BC47F6472F466845A144D944114349428041B740EE4025",
INIT_06 => X"57E75729566B55AC54EC542C536C52AB51EA512950674FA44EE14E1E4D5A4C96",
INIT_07 => X"638062CA6214615E60A75FEF5F375E7E5DC45D0B5C505B955ADA5A1E596158A4",
INIT_08 => X"6E846DD96D2D6C806BD26B246A7669C66916686667B467026650659D64E96435",
INIT_09 => X"78DE783E779D76FB765975B67512746D73C87322727B71D4712C70836FD96F2F",
INIT_0A => X"827881E5815080BB80257F8E7EF67E5E7DC47D2A7C8F7BF47B577ABA7A1C797D",
INIT_0B => X"8B418ABB8A3489AC8924889A880F878486F8866B85DD854E84BF842E839D830B",
INIT_0C => X"932A92B2923991C0914590CA904E8FD18F528ED38E548DD38D518CCE8C4B8BC7",
INIT_0D => X"9A2499BC995298E8987D981097A3973596C5965595E4957294FF948B941693A0",
INIT_0E => X"A0289FCF9F759F1A9EBE9E629E049DA59D459CE59C839C209BBD9B589AF39A8C",
INIT_0F => X"A52CA4E3A499A44FA403A3B6A368A31AA2CAA279A227A1D5A181A12CA0D6A07F",
INIT_10 => X"A92DA8F4A8BBA880A845A808A7CBA78CA74DA70CA6CBA688A644A600A5BAA573",
INIT_11 => X"AC29AC01ABD8ABAEAB82AB56AB29AAFBAACBAA9BAA6AAA38AA04A9D0A99BA964",
INIT_12 => X"AE22AE0AADF1ADD7ADBCADA0AD83AD65AD46AD26AD05ACE2ACBFAC9BAC76AC50",
INIT_13 => X"AF1CAF13AF0AAF00AEF5AEE9AEDBAECDAEBEAEAEAE9DAE8BAE78AE64AE4FAE39",
INIT_14 => X"AF1DAF24AF2AAF2FAF34AF37AF39AF3AAF3BAF3AAF39AF36AF33AF2EAF29AF23",
INIT_15 => X"AE31AE46AE5BAE6FAE81AE93AEA4AEB5AEC4AED2AEE0AEECAEF8AF03AF0CAF15",
INIT_16 => X"AC62AC85ACA8ACC9ACEAAD0AAD29AD47AD65AD81AD9DADB8ADD2ADEBAE03AE1A",
INIT_17 => X"A9C0A9F0AA1FAA4EAA7CAAA8AAD5AB00AB2AAB54AB7DABA5ABCDABF3AC19AC3E",
INIT_18 => X"A65CA698A6D3A70DA747A77FA7B7A7EFA825A85BA891A8C5A8F9A92CA95EA98F",
INIT_19 => X"A24AA28FA2D5A319A35EA3A1A3E4A426A468A4A8A4E9A528A567A5A6A5E3A620",
INIT_1A => X"9D9D9DEC9E3A9E889ED59F229F6E9FBAA005A050A09AA0E3A12CA174A1BCA203",
INIT_1B => X"986D98C39919996F99C49A199A6D9AC19B149B679BB99C0B9C5C9CAD9CFE9D4D",
INIT_1C => X"92D2932E938A93E69441949C94F7955195AB9605965E96B7970F976797BF9816",
INIT_1D => X"8CE58D468DA68E068E668EC68F268F858FE4904390A190FF915D91BB92189275",
INIT_1E => X"86C08723878787EA884D88B08913897589D88A3A8A9C8AFE8B608BC18C238C84",
INIT_1F => X"807E80E3814781AB8210827482D9833D83A18405846984CD8531859585F9865C",
INIT_20 => X"7A3A7A9E7B027B667BCA7C2E7C927CF67D5B7DBF7E237E887EEC7F517FB5801A",
INIT_21 => X"740F747074D27534759675F8765A76BD7720778277E5784978AC790F797379D6",
INIT_22 => X"6E176E756ED26F306F8F6FED704C70AB710B716B71CA722B728B72EC734C73AE",
INIT_23 => X"686E68C5691E697669CF6A296A826ADD6B376B926BED6C496CA46D016D5D6DBA",
INIT_24 => X"632B637C63CD641F647164C36516656A65BE6612666766BD6712676867BF6816",
INIT_25 => X"5E685EB05EF95F425F8C5FD66021606C60B861056152619F61EE623C628B62DB",
INIT_26 => X"5A3C5A7A5AB85AF85B385B785BB95BFB5C3E5C815CC55D095D4E5D945DDA5E21",
INIT_27 => X"56BB56EE57215755578A57C057F6582D5865589D58D65910594B598659C259FE",
INIT_28 => X"53FA54205447546E549754C054EB55165541556E559B55C955F8562856585689",
INIT_29 => X"52095221523B52555270528D52AA52C752E65306532653475369538C53B053D4",
INIT_2A => X"50F85102510D51195126513451435153516351755187519B51AF51C451DA51F1",
INIT_2B => X"50D350CE50CA50C750C550C450C450C550C750CA50CE50D250D850DE50E650EE",
INIT_2C => X"51A55191517D516B515951485139512A511D5110510450FA50F050E750E050D9",
INIT_2D => X"53755351532D530B52E952C952A9528B526D52515235521B520151E951D151BB",
INIT_2E => X"5649561455E055AD557B554B551B54EC54BE54925466543B541253E953C2539B",
INIT_2F => X"5A2159DB59975954591258D158915852581457D7579B5760572656ED56B5567E",
INIT_30 => X"5EFC5EA75E535DFF5DAD5D5C5D0C5CBC5C6E5C215BD55B895B3F5AF65AAE5A67",
INIT_31 => X"64D86472640E63AB634962E86288622861CA616D611160B6605B60025FAA5F52",
INIT_32 => X"6BAC6B386AC46A5269E0696F69006891682367B6674B66E06676660D65A5653E",
INIT_33 => X"737072ED726B71E9716970E9706B6FED6F716EF56E7A6E006D876D0F6C986C21",
INIT_34 => X"7C167B857AF67A6679D8794B78BE783277A7771D7694760C758574FE747873F4",
INIT_35 => X"859184F3845683BA831F828581EB815280BA80237F8C7EF77E627DCE7D3A7CA8",
INIT_36 => X"8FCD8F248E7C8DD48D2D8C878BE18B3C8A9889F5895288B0880E876E86CE862F",
INIT_37 => X"9AB99A05995298A097EF973E968D95DE952F948093D29325927991CD91229077",
INIT_38 => X"A63CA580A4C4A409A34EA294A1DAA121A0699FB19EF99E429D8C9CD69C219B6D",
INIT_39 => X"B23FB17CB0B8AFF6AF34AE72ADB0ACEFAC2FAB6FAAAFA9F0A932A873A7B6A6F8",
INIT_3A => X"BEA8BDDFBD17BC4EBB86BABEB9F7B92FB869B7A2B6DCB616B551B48CB3C7B303",
INIT_3B => X"CB5CCA90C9C3C8F6C82AC75EC692C5C6C4FBC430C365C29AC1D0C105C03BBF72",
INIT_3C => X"D83FD770D6A1D5D2D503D435D366D298D1CAD0FBD02DCF60CE92CDC4CCF7CC2A",
INIT_3D => X"E531E462E393E2C4E1F5E125E056DF87DEB8DDE8DD19DC4ADB7BDAACD9DDD90E",
INIT_3E => X"F215F148F07BEFADEEDFEE11ED43EC75EBA7EAD9EA0AE93BE86DE79EE6CFE600",
INIT_3F => X"FECDFE03FD39FC6FFBA5FADAFA0FF944F879F7ADF6E1F615F549F47CF3AFF2E3")
		    
		port map (
			DO => DO2,						-- Output read data port, width defined by READ_WIDTH parameter
			RDADDR => std_logic_vector(vecAddrRead),					-- Input address, width defined by port depth
			RDCLK => clk,	 						-- 1-bit input clock
			RST => RamReset,							-- active high reset
			RDEN => '1',							-- read enable 
			REGCE => '1',							-- 1-bit input read output register enable - ignored
			DI => DI,						-- Input data port, width defined by WRITE_WIDTH parameter
			WE => "00" ,					-- since RAM is byte read, this determines high or low byte
			WRADDR => "0000000000",					-- Input write address, width defined by write port depth
			WRCLK => clk,							-- 1-bit input write clock
			WREN => '0' -- CHANGE TO MUX
			);	
 
Signal1 <= unsigned(DO) * amplitude;
--Signal1_signed <= signed(Signal1(31 downto 16)) - X"8000";
Signal1_extend <= std_logic_vector(Signal1(31 downto 16)- X"8000" ) & "00";

process (clk)
    begin
	if (rising_edge(clk)) then
	    if reset_n = '0' then
		L_bus_in <= (others => '0');
		--R_bus_in <= (others => '0');				
	    elsif(ready = '1') then
		L_bus_in <= Signal1_extend;
		--R_bus_in <= R_bus_out;
	    end if;
	end if;
end process;
 
 

    
process(clk)
    begin
        if(rising_edge(clk)) then
            if(reset_n='0') then
                old_button <= "00000";
            else
               old_button <= btn;
               -- Button Activity 
        button_activity <= (old_button XOR btn) and btn;
            end if;
        end if;
end process;

	------------------------------------------------------------------------------
	-- If a button has been pressed then increment of decrement the trigger vars
	------------------------------------------------------------------------------
process(clk)
    begin
        if(rising_edge(clk)) then
             if reset_n = '0' then
                amplitude <= X"3fff";
                Phase_inc <= X"0259";
             end if;

            if (button_activity(0) = '1') then
                    -- DOWN BTTN  DECREMENT AMP
                amplitude <= amplitude + (X"0" & unsigned(Slide(7 downto 0)) & X"0");      
                  
            end if;
            
            if (button_activity(2) = '1') then
                    -- UP BTTN  INC AMP
                 amplitude <= amplitude - (X"0" & unsigned(Slide(7 downto 0)) & X"0");    
            end if;
            
            if (button_activity(1) = '1') then
                    --LEFT BTTN DECRESE PHASE
                     Phase_inc <= Phase_inc - (X"00" & unsigned(Slide(7 downto 0)));
            end if;
            
            if (button_activity(3) = '1') then                
                    --RIGHT BTTN INCRESE PHASE
               Phase_inc <= Phase_inc + (X"00" & unsigned(Slide(7 downto 0)));
            end if;
            
            if (button_activity(4) = '1') then       
                    --CENTER BTTN
                if (chan = '0') then
                    chan <= '1';
                elsif (chan = '1') then
                    chan <= '0';                    
                end if;
            end if;            
        end if;
end process;    

DO <= DO1 when chan = '0' else DO2;

end Behavioral;
